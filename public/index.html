<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Minimal TODO App</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 500px; margin: 30px auto; }
        input { padding: 8px; width: 70%; }
        button { padding: 8px; }
        ul { list-style: none; padding: 0; }
        li { padding: 6px 0; }
        li span { cursor: pointer; margin-left: 10px; color: red; }
    </style>
</head>
<body>
    <h2>TODO List</h2>
    <form id="todo-form">
        <input type="text" id="todo-text" placeholder="Enter todo" required>
        <button type="submit">Add</button>
    </form>
    <ul id="todo-list"></ul>

    <script>
        const todoForm = document.getElementById('todo-form');
        const todoText = document.getElementById('todo-text');
        const todoList = document.getElementById('todo-list');

        async function fetchTodos() {
            const res = await fetch('/api/todos');
            const todos = await res.json();
            todoList.innerHTML = '';
            todos.forEach(todo => {
                const li = document.createElement('li');
                li.textContent = todo.text;
                const del = document.createElement('span');
                del.textContent = 'X';
                del.onclick = async () => {
                    await fetch(`/api/todos/${todo._id}`, { method: 'DELETE' });
                    fetchTodos();
                };
                li.appendChild(del);
                todoList.appendChild(li);
            });
        }

        todoForm.onsubmit = async (e) => {
            e.preventDefault();
            if (!todoText.value.trim()) return;
            await fetch('/api/todos', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: todoText.value })
            });
            todoText.value = '';
            fetchTodos();
        };

        fetchTodos();
    </script>
</body>
</html>